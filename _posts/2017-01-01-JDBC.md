---
layout: post
title: "JDBC와 MVC Pattern 에 대한 이해"
description: "JDBC와 MVC Pattern 에 대한 이해"
modified: 2017-01-01
tags: [blog]
comments: true
image:
  feature: back1.jpg
---


<section id="table-of-contents" class="toc">
  <header>
    <h3>Overview</h3>
  </header>
<div id="drawer" markdown="1">
*  Auto generated table of contents
{:toc}
</div>
</section><!-- /#table-of-contents -->


간단한 도서검색 프로그램을 작성하면서 JDBC와 MVC Pattern에 대해 이해하고 이를 바탕으로 Spring의 DI개념에 대해서 이해해 보자

## Database 세팅

1. MySQL 이용 - v5.7  , MySQL Workbench UI 툴 이용
2. ID/PW : root/cps431 
3. 데이터가 저장돌 데이터베이스를 생성 library 스키마 생성
4. 새로운 사용자가 방금 만든 데이터베이스를 사용할 수 있도록 권한부여
5. 생성된 데이터베이스에 Table을 만들어서 데이터를 집어 넣어는다.
6. 한빛미디어 IT계열 책에대한 정보를 사용하여 테이블로 만듬. 

<figure>
<p style="text-align: center;">	
	<img src="/images/book1.png">
</p>
</figure>


## 데이터베이스를 Access 하는 자바 프로그램 작성(아주 무식한 방법)

1. Project를 생성하고 클래스를 만들어서 main method 내에서 모든걸 처리!!
2. Maven을 사용하여 MySQL 라이브러리를 주입 Dependency Injection
3. 콘솔창으로 입력을받고 데이터베이스 로직 처리를 한 후 결과를 출력 

```java

package book;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.util.Scanner;

public class Main {

	public static void main(String[] args) {
		//프로그램 작성
		// 1. 입력을 받아요
		// 책 제목에 대한 keyword를 받는다.
		System.out.print("키워드를 입력하세요 =>");
		
		//도스창으로부터 입력을 받기위해 Scanner 객체 생성
		//Scanner 객체로 도스창으로부터 입력을 하나씩 받는다. 
		Scanner s = new Scanner(System.in);
		String keyword = s.nextLine();
		
		
		// 2. 로직 처리를 해요
		// 데이터베이스 처리를 해요!!
		try{
			//2-1. 드라이버 로딩
			//자바프로그램이 MySQL에 접근하기 위해서 필요한 라이브러리를 불러들인다.
			//pom.xml 에 MySQL에 대한 dependency를 입력해서 라이브러리를 다운로드 받는다.
			Class.forName("com.mysql.jdbc.Driver");
			System.out.println("Driver loading Success");
			
			
			//2-2 실제 데이터베이스에 접속
			//어떤 데이터베이스에 접속할 건지, 아이디와 패스워드가 필요
			String url = "jdbc:mysql://localhost:3306/library";
			String id = "root";
			String pw = "cps431";
			Connection con = DriverManager.getConnection(url,id,pw);
			System.out.println("Database loading Success");
			
			//2-3.SQL문을 실행하기 위한 Statement를 생성한다.
			String sql ="select btitle,bauthor from book where btitle like ?";
			PreparedStatement pstmt = con.prepareStatement(sql);
			
			//sql문에 내가 원하는 문자열을 넣는 작업
			//첫번째 물음표에 , keyword를 넣는다.
			//% 와일드문자는 0개이상의 문자를 의미한다. 즉 keyword를 포함하고 있는 문자열을 ?에 넣는다.
			pstmt.setString(1,"%"+ keyword + "%"); 
			
			
			//2-4 Statement 실행!!
			//수행한 쿼리문의 결과를 가져옴
			//rs 는 테이블 라인을 가리키는 포인터. 한칸씩 내려가면서 라인을 가리킴
			ResultSet rs = pstmt.executeQuery();
			
			//2-5 결과처리
			//반복 해서 rs.next() 를 수행하고
			//btitle 컬럼명의 열의 문자열을 가져와라.
			while(rs.next())
			{
				System.out.println("책 제목:" + rs.getString("btitle"));
			}
		
			//2-6 사용한 리소스 정리
			rs.close();
			pstmt.close();
			con.close();
			
			
		}catch(Exception e){
			//만약 오류가 생기면 오류 출력
			System.out.println(e);
		}
		
		// 3. 출력해요
	}

}


```


<figure>
<p style="text-align: center;">	
	<img src="/images/book2.png">
</p>
</figure>
- rs는 테이블의 라인을 가리키는 포인터이다.
- 한라인 씩 내려가면서 가리킴

<figure>
<p style="text-align: center;">	
	<img src="/images/book3.png">
</p>
</figure>

- rs.next()로 한라인 내려간후 지정된 컬럼명의 문자열을 가져옴